{"version":3,"file":"bobo-router.esm.js","sources":["../src/context.ts","../src/mode.ts","../src/tools.ts","../src/useLocation.ts","../src/matcher.ts","../src/index.ts","../src/helper.ts","../src/index.ts"],"sourcesContent":["import { createContext } from 'react'\n\nexport type isMatch = boolean\nexport type params = {[key:string]:any}\nexport type matchFn = (pattern:string | RegExp,path:string) => [isMatch,params]\n\nexport interface store {\n    v:{\n        base:string\n        leaveGuardMap:{[path:string]:Function}\n        enterGuardMap:{[path:string]:Function}\n        prevPath:string\n        matcher:matchFn\n    }, \n    [customData:string]:any\n}\n\nexport const RouterCtx = createContext<store>({} as store)","enum RouteMode {\n    history,\n    hash\n}\n\nlet routeMode = RouteMode.history\nconst setRouteMode = (mode: RouteMode) => {\n    routeMode = mode\n}\n\nexport {\n    routeMode,\n    RouteMode,\n    setRouteMode\n}","import { useRef, useCallback, useEffect } from 'react'\n\nconst useActionEffect = (action:Function,deps:unknown[]) => {\n    const depRef = useRef<unknown[]>()\n    if(isEqual(depRef.current,deps)) return\n    \n    action()\n    depRef.current = deps\n}\n\nconst useEventCallback = (fn:Function, deps: unknown[]) => {\n    const ref = useRef<Function>(() => Error('useEventCallback must init first!'))\n    \n    useEffect(() => {\n        ref.current = fn\n    },deps)\n\n    return useCallback(() => {\n        return ref.current()\n    },[fn, ref])\n}\n\nfunction is(x:unknown, y:unknown) {\n    if (x === y) {\n        return x !== 0 || y !== 0 || 1 / x === 1 / y\n    } else {\n        return x !== x && y !== y\n    }\n}\n  \nfunction isEqual(old,cur) {\n    if(is(old,cur)) return true\n    if(typeof old !== 'object' || typeof cur !== 'object') return false\n\n    const oldKeys = Object.keys(old)\n    const curKeys = Object.keys(cur)\n    \n    if(oldKeys.length !== curKeys.length) return false\n    // plain object or array\n    curKeys.forEach((key) => {\n        if(cur[key] !== old[key]) return false\n    })\n    return true\n}\n\nexport {\n    useEventCallback,\n    useActionEffect\n}","import { useEffect,useState,useCallback,useRef,useContext } from 'react'\nimport { RouterCtx,store } from './context'\nimport { routeMode, RouteMode } from './mode'\nimport { useEventCallback } from './tools'\ndeclare namespace history {\n    function pushState(...p:any[]) : void\n    function replaceState(...p:any[]) : void\n    function popState(...p:any[]): void\n}\ntype navigate = (url:string,type ?: \"replace\" | \"to\") => void\n// to: '*' || from: '*' \nenum GuardKeyAny {\n    to,\n    from\n}\n\nconst NOOP = () => {}\nlet INIT_PATCH_HISTORY_EVENT = 0\nconst useLocation = ({ base = \"\" } = {}):[string,navigate] => {\n    // only update component\n    const [path,update] = useState<string>(getCurrentPathname(base)) \n    const prevPath = useRef(path)\n    const globalRef = useRef<store['v']>(useContext(RouterCtx).v as any as store['v'])\n\n    const checkUpdate = useEventCallback(() => {\n        let curPath = getCurrentPathname(base)\n        // globalRef.current.prevPath = prevPath.current\n        prevPath.current !== curPath && update((prevPath.current = curPath))\n    },[base, update])\n\n    useEffect(() => {\n        INIT_PATCH_HISTORY_EVENT || (INIT_PATCH_HISTORY_EVENT = 1,patchHistoryEvent(globalRef.current))\n        \n        const historyModeSubscribeEvent = ['replaceState','pushState','popState']\n        const hashModeSubscribeEvent = 'hashChange'\n        // subscribe dep. wait emit...\n        if(routeMode === RouteMode.history) historyModeSubscribeEvent.forEach((event) => {\n            addEventListener(event,checkUpdate)\n        }) \n        else if(routeMode === RouteMode.hash) addEventListener(hashModeSubscribeEvent, checkUpdate)\n\n        // checkUpdate()\n        return () => {\n            if(routeMode === RouteMode.history) historyModeSubscribeEvent.forEach((event) => {\n                removeEventListener(event,checkUpdate)\n            }) \n            else removeEventListener(hashModeSubscribeEvent, checkUpdate)\n        }\n    },[base])\n\n    const navigate:navigate = useCallback((url:string,type:\"replace\" | \"to\" = \"to\") => {\n        // path handle by patchHistoryEvent: 4th param\n        if(routeMode === RouteMode.history) history[type == \"replace\" ? \"replaceState\" : \"pushState\"](0,'0',base + url, path)\n        else if(routeMode === RouteMode.hash) location.hash = base + url\n    },[path])\n\n    return [path,navigate]\n}  \n\nfunction patchHistoryEvent(globalRef:store['v']) {\n    if(routeMode === RouteMode.history) {\n        ['replaceState','pushState'].forEach((event) => {\n            const ORIGINAL_EVENT = history[event]\n            history[event] = function(state:any,title:string,to:string,path:string) {\n                // leave guard: when false refuse navigate\n                let _next = false\n                const next = () => _next = true\n                if(to) {\n                    const [guardKey1, guardKey2] = generateGuardKeys(path, to)\n                    let beforeLeaveGuard = to !== path && ( globalRef.leaveGuardMap[guardKey1] || globalRef.leaveGuardMap[guardKey2])  \n                    \n                    if(!beforeLeaveGuard) {\n                        // fuzzy match for params case \n                        // eg: /url/:id\n                        const matched = fuzzyMatchGuard(globalRef,to,path)\n                        matched && (beforeLeaveGuard = globalRef.leaveGuardMap[matched[0]])\n    \n                        if(!beforeLeaveGuard) next()\n                    }\n                    if(beforeLeaveGuard) {\n                        beforeLeaveGuard(next)\n                    }\n                }\n    \n                if(!_next) return null\n                const result = ORIGINAL_EVENT.apply(this,[state,title,to])\n                const subscribeEvent = new CustomEvent(event,{ detail: { to,path } })\n                dispatchEvent(subscribeEvent)\n              \n                return result\n            }\n    \n            window.onpopstate = () => {\n                const from = globalRef.prevPath,\n                    to = location.pathname\n                const [guardKey1, guardKey2] = generateGuardKeys(from, to)\n                let beforeLeaveGuards = from !== to && ( globalRef.leaveGuardMap[guardKey1] || globalRef.leaveGuardMap[guardKey2]) \n                // browser back action not refuse\n                beforeLeaveGuards && beforeLeaveGuards(NOOP)\n                \n                const popEvent = new CustomEvent('popState')\n                dispatchEvent(popEvent)\n            }\n        })\n    }\n    else if(routeMode === RouteMode.hash) {\n        window.onhashchange = (event:HashChangeEvent) => {\n            const [guardKey1, guardKey2] = generateGuardKeys(getHashFromHref(event.oldURL), getHashFromHref(event.newURL))\n            let beforeLeaveGuard = event.oldURL !== event.newURL && (globalRef.leaveGuardMap[guardKey1] || globalRef.leaveGuardMap[guardKey2])\n            beforeLeaveGuard && beforeLeaveGuard(() => {})\n\n            const hashChangeEvent = new CustomEvent('hashChange')\n            dispatchEvent(hashChangeEvent)\n        }\n    }\n} \n\nfunction generateGuardKeys(from: string, to: string, any:GuardKeyAny = GuardKeyAny.to) {\n    return [\n        JSON.stringify({from, to}),\n        any === GuardKeyAny.to ? JSON.stringify({from, to: '*'}) : JSON.stringify({from: '*', to})\n    ]\n}\n\nfunction getCurrentPathname(base,pathname ?: string) {\n    // from basepath\n    if(routeMode === RouteMode.history) {\n        pathname = location.pathname\n        return !pathname.indexOf(base) ? pathname.slice(base.length) || '/' : pathname\n    }\n    else if(routeMode === RouteMode.hash) {\n        return getHashFromHref(location.href)\n    }\n}\n\nfunction getHashFromHref(path: string) {\n    debugger\n    const hashIndex = path.indexOf('#')\n    if(!~hashIndex) path = '/'\n    else path = path.slice(hashIndex + 1)\n    \n    return path\n}\n\nfunction fuzzyMatchGuard(globalRef:store['v'],to:string,from:string = '*', leaveGuardMap:string = \"leaveGuardMap\"):[string,any[]]{\n    const matcher = globalRef.matcher\n    const registeredGuardKeys = Object.keys(leaveGuardMap === 'leaveGuardMap' ? globalRef.leaveGuardMap : globalRef.enterGuardMap)\n\n    let params = null\n    const matched = registeredGuardKeys.find((guardGroupStr) => {\n        const guardGroup = JSON.parse(guardGroupStr)\n        if(guardGroup['from'] == from) {\n            let result\n            if((result = matcher(guardGroup['to'],to))[0]) {\n                params = result[1]\n                return true\n            } \n        }\n    })\n    return [matched,params]\n}\n\nexport {\n    fuzzyMatchGuard,\n    navigate,\n    useLocation\n}","// eslint-disable-next-line\nexport default function makeMatcher(makeRegexpFn = pathToRegexp) {\n    let cache = {}\n  \n    // obtains a cached regexp version of the pattern\n    const getRegexp = pattern =>\n        (cache[pattern]) || (cache[pattern] = makeRegexpFn(pattern))\n  \n    return (pattern, path) => {\n        const { regexp, keys } = getRegexp(pattern || \"\")\n        const out = regexp.exec(path)\n  \n        if (!out) return [false, null]\n  \n        // formats an object with matched params\n        const params = keys.reduce((params, key, i) => {\n            params[key.name] = out[i + 1]\n            return params\n        }, {})\n  \n        return [true, params]\n    }\n}\n  \nconst escapeRx = str => str.replace(/([.+*?=^!:${}()[\\]|/\\\\])/g, \"\\\\$1\")\n  \nconst rxForSegment = (repeat, optional, prefix) => {\n    let capture = repeat ? \"((?:[^\\\\/]+?)(?:\\\\/(?:[^\\\\/]+?))*)\" : \"([^\\\\/]+?)\"\n    if (optional && prefix) capture = \"(?:\\\\/\" + capture + \")\"\n    return capture + (optional ? \"?\" : \"\")\n}\n  \nconst pathToRegexp = pattern => {\n    const groupRx = /:([A-Za-z0-9_]+)([?+*]?)/g\n  \n    let match = null,\n        lastIndex = 0,\n        keys = [],\n        result = \"\"\n  \n    while ((match = groupRx.exec(pattern)) !== null) {\n        const [_, segment, mod] = match\n  \n        const repeat = mod === \"+\" || mod === \"*\"\n        const optional = mod === \"?\" || mod === \"*\"\n        const prefix = optional && pattern[match.index - 1] === \"/\" ? 1 : 0\n  \n        const prev = pattern.substring(lastIndex, match.index - prefix)\n  \n        keys.push({ name: segment })\n        lastIndex = groupRx.lastIndex\n  \n        result += escapeRx(prev) + rxForSegment(repeat, optional, prefix)\n    }\n  \n    result += escapeRx(pattern.substring(lastIndex))\n    return { keys, regexp: new RegExp(\"^\" + result + \"(?:\\\\/)?$\", \"i\") }\n}\n","import { useLocation as useLocationHook,navigate,fuzzyMatchGuard }  from './useLocation'\nimport makeMatcher from \"./matcher\"\nimport { useActionEffect } from './tools'\nimport { routeMode, setRouteMode, RouteMode } from './mode'\n\nimport {\n    useRef,\n    useLayoutEffect,\n    useEffect,\n    useContext,\n    useCallback,\n    isValidElement,\n    cloneElement,\n    createElement as h,\n    Suspense,\n    lazy,\n} from \"react\"\n\nimport { RouterCtx,store,isMatch,params,matchFn } from './context'\nexport { getParams } from './helper'\n\ninterface ILeaveGuard {\n    (navigate:Function, next:Function):void\n}\n\ninterface IEnterGuard {\n    (params: Object, navigate:Function, next: Function):void\n}\n\ntype RouteProps = {\n    path:string,\n    match ?: matchFn\n    enterGuard ?: EnterRouteGuard,\n    updateGuard ?: UpdateRouteGuard,\n    component ?: React.FC | React.ComponentClass,\n    exact ?: boolean,\n    isAlive ?: boolean\n} \n\ntype updateGuardStruct = {\n    timer:number;\n    path:string;\n    prevParams:params;\n}\n\ntype guardTypes = 'beforeLeave' | 'beforeUpdate' | 'beforeEnter'\n\ninterface RouterGuard {\n    path ?: string,\n    to:string,\n    resolve:(navigate:navigate,next:Function) => void,\n    type:\"beforeLeave\" | \"beforeEnter\"\n} \n\ninterface EnterRouteGuard {\n    (params:any,navigate:navigate,next:Function) : void,\n}\n\ninterface UpdateRouteGuard {\n    (beforeParams:params,currentParams:params,navigate:Function,next:Function):void\n}\n\nenum ExecuteGuardType {\n    None,\n    Update,\n    // If not in exact mode. However should execute update instead enter\n    Update_UnResolve,\n    Enter,\n}\n\nconst buildRouter = ({\n    base = \"\",\n    matcher = makeMatcher() as any,\n    enterGuardMap = {},\n    leaveGuardMap = {},\n    prevPath = \"\"\n}:store['v'] = {} as store['v']) => ({ base, matcher,leaveGuardMap,prevPath, enterGuardMap })\n\nconst useRouter = () => {\n    const globalRef = useContext(RouterCtx)\n    return globalRef.v || (globalRef.v = buildRouter())\n}\n\nconst useLocation = () => {\n    const router = useRouter()\n    return useLocationHook(router)\n}\n\nconst useRoute = (pattern:RegExp | string):[[isMatch,params],string,(type:\"replace\" | \"to\",url:string) => void] => {\n    const [path,navigate] = useLocation()\n    return [useRouter().matcher(pattern, path),path,navigate]\n}\n\nconst useNestRoute = (pattern:RegExp | string,prevMatchObject?:updateGuardStruct):[[isMatch,params],string,(type:\"replace\" | \"to\",url:string) => void] => {\n    const [path,navigate] = useLocation()\n    const matcher = useRouter().matcher\n\n    const match_paths = path.split('/')\n    let routeMatch:[isMatch,params] = [false,{}]\n\n    // avoid '/' Component show in any router\n    for(let i = 1,base = \"/\";i < match_paths.length;i++) {\n        let curPath = base + match_paths[i]\n        const result = matcher(pattern,curPath)\n        if(result[0]) {\n            if(prevMatchObject) {\n                if(prevMatchObject!.path !== curPath) {\n                    prevMatchObject.path = curPath\n                    prevMatchObject.timer++\n                    prevMatchObject.prevParams = result[1]\n                }\n            } \n            routeMatch = result\n            break\n        }\n        base += match_paths[i] + '/'\n    }\n    routeMatch[0] || prevMatchObject && (prevMatchObject.timer = 0,prevMatchObject.prevParams = {})\n    return [routeMatch,path,navigate]\n}\n\nconst Router = props => {\n    const ref = useRef<null | store>(null)\n\n    // only in first render to call buildRouter\n    const value = ref.current || (ref.current = { v: buildRouter(props) })\n\n    return h(RouterCtx.Provider, {\n        value: value,\n        children: props.children\n    })\n}\n\nconst Route:React.FC<RouteProps> = ({ path, match, component, children, enterGuard,updateGuard,exact = false,isAlive }) => {\n    const updateParamsRef = useRef<updateGuardStruct>({ path: \"\",timer: 0,prevParams: {} })\n    const prevParams = updateParamsRef.current.prevParams\n    const [routeMatch,basePath,navigate] = !exact ? useNestRoute(path,updateParamsRef.current) : useRoute(path)\n    const globalCtx = useRouter()\n\n    useActionEffect(() => {\n        if(!enterGuard) return\n        let guardGroup = JSON.stringify({ from: '*',to: path })\n        globalCtx.enterGuardMap[guardGroup] = (params,next) => enterGuard(params,navigate,next)\n    },[enterGuard])\n    const [matches, params] = match && match(path,basePath) || routeMatch\n\n    if(!matches) {\n        if(!isAlive) return null\n        else return renderChild({ display: 'none' })\n    }\n\n    // beforeEnter | beforeUpdate guard\n    globalCtx.prevPath = basePath\n    // judge execute RouteGuard Type\n    // Type: Update | Enter \n    // emit UpdateGuard\n    let _next = false\n    const next = () => _next = true\n    let executeGuardType = ExecuteGuardType.Enter\n    if(updateParamsRef.current.timer > 1) {\n        // only emit UpdateGuard in unExact Mode \n        if(!exact) {\n            if(updateGuard) {\n                updateGuard(prevParams,updateParamsRef.current.prevParams,navigate,next)\n            } else next()\n            executeGuardType = ExecuteGuardType.Update\n        }\n        else executeGuardType = ExecuteGuardType.Update_UnResolve\n    }\n\n    if(executeGuardType == ExecuteGuardType.Enter) {\n        const from = '*'\n        const guardGroup = JSON.stringify({ from: from,to: basePath })\n        const executeGuard = globalCtx.enterGuardMap[guardGroup]  \n        \n        if(executeGuard) {\n            executeGuard(null,next) \n        } else {\n            const matched = fuzzyMatchGuard(globalCtx,basePath, '*', 'enterGuardMap')\n            if(matched[0]) {\n                const fuzzyExecuteGuard = globalCtx.enterGuardMap[matched[0]]\n                fuzzyExecuteGuard(matched[1],next)\n            }\n            else next()\n        }\n    }\n\n    if(!_next) return null\n    return renderChild()\n\n    function renderChild(extraProps ?: object) {\n        if (component) return h(component, { params,...extraProps } as any)\n\n        // support render prop or plain children\n        return typeof children === \"function\" ? cloneElement(children(params),extraProps) : cloneElement(children as any,extraProps)\n    }\n}\n\nconst useLeaveGuard = (props:Exclude<RouterGuard, 'type'>) => {\n    const [curPath,navigate] = useLocationHook()\n    const { path = curPath,resolve,to } = props\n    const globalRef = useContext(RouterCtx)\n    \n    useEffect(() => {  \n        let realPath = path\n        const currentGuardFlagGroup = JSON.stringify({ from: realPath,to })\n        globalRef.v.leaveGuardMap[currentGuardFlagGroup] = next => resolve(navigate,next)\n    },[path,resolve,to])\n}\n\nconst connectGuard = (type:Exclude<guardTypes,'beforeUpdate'>,resolve:ILeaveGuard | IEnterGuard,from:string,to?:string) => (Component:React.FC):React.FC => {\n    if(type === 'beforeEnter' || !to) {\n        to = '*'\n    }\n\n    return (props) => {\n        const { children,...others } = props\n        const matcher = useRouter().matcher\n        const globalRef = useContext(RouterCtx)\n        const { prevPath } = globalRef.v\n        const [curPath,navigate] = useLocationHook()\n\n        let nextRender = 0\n        const next = () => {\n            nextRender = 1\n        }\n\n        if(type === 'beforeEnter' ) {\n            if(from === '*' || matcher(from,prevPath)[0]) {\n                (resolve as IEnterGuard)(prevPath,navigate,next)\n            }\n        } else if(type === 'beforeLeave') {\n            const resolve1:ILeaveGuard = resolve as ILeaveGuard\n            useLeaveGuard({\n                resolve: resolve1,\n                to,\n                type: 'beforeLeave'\n            })\n            nextRender = 1\n        }\n\n        if(nextRender) return h(Component,others,children)\n        return h('div')\n    }\n}\n\nconst Link = props => {\n    const [, navigate] = useLocation()\n    const { base } = useRouter()\n\n    const href = props.href || props.to\n    const { children, onClick, tag } = props\n\n    const handleClick = useCallback(\n        event => {\n            if (\n                event.ctrlKey ||\n                event.metaKey ||\n                event.altKey ||\n                event.shiftKey ||\n                event.button !== 0\n            )\n                return\n\n            event.preventDefault()\n            navigate(href)\n            onClick && onClick(event)\n        },\n        [href, onClick, navigate]\n    )\n\n    const extraProps = { href: base + href, onClick: handleClick, to: null }\n    // default render 'a' component\n    const render = isValidElement(children) ? children : h(tag ? tag : \"a\", props)\n\n    return cloneElement(render, extraProps)\n}\n\nconst Switch = ({ children, location }) => {\n    const { matcher } = useRouter()\n    const [originalLocation] = useLocation()\n\n    children = Array.isArray(children) ? children : [children]\n\n    for (const element of children) {\n        let match:[boolean,params]\n\n        if (\n            isValidElement(element) &&\n            \n      // this allows to use different components that wrap Route\n      // inside of a switch, for example <AnimatedRoute />.\n      (match = element.props['path']\n          ? matcher(element.props['path'], location || originalLocation)\n          : [false, {}]\n      )[0]\n        )\n            return cloneElement(element, { match,path: element.props['path'] } as any)\n    }\n\n    // eslint-disable-next-line\n    console.warn(`\n        Switch component has no suitable render element;\n        please check path prop\n    `)\n    return null\n}\n\nconst Redirect = props => {\n    const [, push] = useLocation()\n    useLayoutEffect(() => {\n        // layout has finished \n        // replace url to new \n        push(\"replace\" ,props.href || props.to)\n\n    // we pass an empty array of dependecies to ensure that\n    // we only run the effect once after initial render\n    }, []) \n\n    return null\n}\n\n\nconst Lazy:React.FC<{loading:React.ReactNode,component:() => Promise<{default:React.ComponentType}>}> = ({ loading,component }) => {\n    const RC = lazy(component) \n    return h(Suspense,{ fallback: loading },h(RC))\n}\n    \nexport {\n    Lazy,\n    Redirect,\n    Switch,\n    useLeaveGuard,\n    connectGuard,\n    Link,\n    useRouter,\n    useLocation,\n    useRoute,\n    useNestRoute,\n    Router,\n    Route,\n    setRouteMode,\n    routeMode,\n    RouteMode\n}","import { useRoute,useNestRoute } from './index'\n\nexport const getParams = (isExact:boolean,pattern:RegExp | string,...params: string[]) => {\n    const current_params = isExact ? useRoute(pattern)[0][1] : useNestRoute(pattern)[0][1]\n    const result = {}\n    for(let param of params) {\n        result[param] = current_params[param]\n    }\n    return result\n}","import { useLocation as useLocationHook,navigate,fuzzyMatchGuard }  from './useLocation'\nimport makeMatcher from \"./matcher\"\nimport { useActionEffect } from './tools'\nimport { routeMode, setRouteMode, RouteMode } from './mode'\n\nimport {\n    useRef,\n    useLayoutEffect,\n    useEffect,\n    useContext,\n    useCallback,\n    isValidElement,\n    cloneElement,\n    createElement as h,\n    Suspense,\n    lazy,\n} from \"react\"\n\nimport { RouterCtx,store,isMatch,params,matchFn } from './context'\nexport { getParams } from './helper'\n\ninterface ILeaveGuard {\n    (navigate:Function, next:Function):void\n}\n\ninterface IEnterGuard {\n    (params: Object, navigate:Function, next: Function):void\n}\n\ntype RouteProps = {\n    path:string,\n    match ?: matchFn\n    enterGuard ?: EnterRouteGuard,\n    updateGuard ?: UpdateRouteGuard,\n    component ?: React.FC | React.ComponentClass,\n    exact ?: boolean,\n    isAlive ?: boolean\n} \n\ntype updateGuardStruct = {\n    timer:number;\n    path:string;\n    prevParams:params;\n}\n\ntype guardTypes = 'beforeLeave' | 'beforeUpdate' | 'beforeEnter'\n\ninterface RouterGuard {\n    path ?: string,\n    to:string,\n    resolve:(navigate:navigate,next:Function) => void,\n    type:\"beforeLeave\" | \"beforeEnter\"\n} \n\ninterface EnterRouteGuard {\n    (params:any,navigate:navigate,next:Function) : void,\n}\n\ninterface UpdateRouteGuard {\n    (beforeParams:params,currentParams:params,navigate:Function,next:Function):void\n}\n\nenum ExecuteGuardType {\n    None,\n    Update,\n    // If not in exact mode. However should execute update instead enter\n    Update_UnResolve,\n    Enter,\n}\n\nconst buildRouter = ({\n    base = \"\",\n    matcher = makeMatcher() as any,\n    enterGuardMap = {},\n    leaveGuardMap = {},\n    prevPath = \"\"\n}:store['v'] = {} as store['v']) => ({ base, matcher,leaveGuardMap,prevPath, enterGuardMap })\n\nconst useRouter = () => {\n    const globalRef = useContext(RouterCtx)\n    return globalRef.v || (globalRef.v = buildRouter())\n}\n\nconst useLocation = () => {\n    const router = useRouter()\n    return useLocationHook(router)\n}\n\nconst useRoute = (pattern:RegExp | string):[[isMatch,params],string,(type:\"replace\" | \"to\",url:string) => void] => {\n    const [path,navigate] = useLocation()\n    return [useRouter().matcher(pattern, path),path,navigate]\n}\n\nconst useNestRoute = (pattern:RegExp | string,prevMatchObject?:updateGuardStruct):[[isMatch,params],string,(type:\"replace\" | \"to\",url:string) => void] => {\n    const [path,navigate] = useLocation()\n    const matcher = useRouter().matcher\n\n    const match_paths = path.split('/')\n    let routeMatch:[isMatch,params] = [false,{}]\n\n    // avoid '/' Component show in any router\n    for(let i = 1,base = \"/\";i < match_paths.length;i++) {\n        let curPath = base + match_paths[i]\n        const result = matcher(pattern,curPath)\n        if(result[0]) {\n            if(prevMatchObject) {\n                if(prevMatchObject!.path !== curPath) {\n                    prevMatchObject.path = curPath\n                    prevMatchObject.timer++\n                    prevMatchObject.prevParams = result[1]\n                }\n            } \n            routeMatch = result\n            break\n        }\n        base += match_paths[i] + '/'\n    }\n    routeMatch[0] || prevMatchObject && (prevMatchObject.timer = 0,prevMatchObject.prevParams = {})\n    return [routeMatch,path,navigate]\n}\n\nconst Router = props => {\n    const ref = useRef<null | store>(null)\n\n    // only in first render to call buildRouter\n    const value = ref.current || (ref.current = { v: buildRouter(props) })\n\n    return h(RouterCtx.Provider, {\n        value: value,\n        children: props.children\n    })\n}\n\nconst Route:React.FC<RouteProps> = ({ path, match, component, children, enterGuard,updateGuard,exact = false,isAlive }) => {\n    const updateParamsRef = useRef<updateGuardStruct>({ path: \"\",timer: 0,prevParams: {} })\n    const prevParams = updateParamsRef.current.prevParams\n    const [routeMatch,basePath,navigate] = !exact ? useNestRoute(path,updateParamsRef.current) : useRoute(path)\n    const globalCtx = useRouter()\n\n    useActionEffect(() => {\n        if(!enterGuard) return\n        let guardGroup = JSON.stringify({ from: '*',to: path })\n        globalCtx.enterGuardMap[guardGroup] = (params,next) => enterGuard(params,navigate,next)\n    },[enterGuard])\n    const [matches, params] = match && match(path,basePath) || routeMatch\n\n    if(!matches) {\n        if(!isAlive) return null\n        else return renderChild({ display: 'none' })\n    }\n\n    // beforeEnter | beforeUpdate guard\n    globalCtx.prevPath = basePath\n    // judge execute RouteGuard Type\n    // Type: Update | Enter \n    // emit UpdateGuard\n    let _next = false\n    const next = () => _next = true\n    let executeGuardType = ExecuteGuardType.Enter\n    if(updateParamsRef.current.timer > 1) {\n        // only emit UpdateGuard in unExact Mode \n        if(!exact) {\n            if(updateGuard) {\n                updateGuard(prevParams,updateParamsRef.current.prevParams,navigate,next)\n            } else next()\n            executeGuardType = ExecuteGuardType.Update\n        }\n        else executeGuardType = ExecuteGuardType.Update_UnResolve\n    }\n\n    if(executeGuardType == ExecuteGuardType.Enter) {\n        const from = '*'\n        const guardGroup = JSON.stringify({ from: from,to: basePath })\n        const executeGuard = globalCtx.enterGuardMap[guardGroup]  \n        \n        if(executeGuard) {\n            executeGuard(null,next) \n        } else {\n            const matched = fuzzyMatchGuard(globalCtx,basePath, '*', 'enterGuardMap')\n            if(matched[0]) {\n                const fuzzyExecuteGuard = globalCtx.enterGuardMap[matched[0]]\n                fuzzyExecuteGuard(matched[1],next)\n            }\n            else next()\n        }\n    }\n\n    if(!_next) return null\n    return renderChild()\n\n    function renderChild(extraProps ?: object) {\n        if (component) return h(component, { params,...extraProps } as any)\n\n        // support render prop or plain children\n        return typeof children === \"function\" ? cloneElement(children(params),extraProps) : cloneElement(children as any,extraProps)\n    }\n}\n\nconst useLeaveGuard = (props:Exclude<RouterGuard, 'type'>) => {\n    const [curPath,navigate] = useLocationHook()\n    const { path = curPath,resolve,to } = props\n    const globalRef = useContext(RouterCtx)\n    \n    useEffect(() => {  \n        let realPath = path\n        const currentGuardFlagGroup = JSON.stringify({ from: realPath,to })\n        globalRef.v.leaveGuardMap[currentGuardFlagGroup] = next => resolve(navigate,next)\n    },[path,resolve,to])\n}\n\nconst connectGuard = (type:Exclude<guardTypes,'beforeUpdate'>,resolve:ILeaveGuard | IEnterGuard,from:string,to?:string) => (Component:React.FC):React.FC => {\n    if(type === 'beforeEnter' || !to) {\n        to = '*'\n    }\n\n    return (props) => {\n        const { children,...others } = props\n        const matcher = useRouter().matcher\n        const globalRef = useContext(RouterCtx)\n        const { prevPath } = globalRef.v\n        const [curPath,navigate] = useLocationHook()\n\n        let nextRender = 0\n        const next = () => {\n            nextRender = 1\n        }\n\n        if(type === 'beforeEnter' ) {\n            if(from === '*' || matcher(from,prevPath)[0]) {\n                (resolve as IEnterGuard)(prevPath,navigate,next)\n            }\n        } else if(type === 'beforeLeave') {\n            const resolve1:ILeaveGuard = resolve as ILeaveGuard\n            useLeaveGuard({\n                resolve: resolve1,\n                to,\n                type: 'beforeLeave'\n            })\n            nextRender = 1\n        }\n\n        if(nextRender) return h(Component,others,children)\n        return h('div')\n    }\n}\n\nconst Link = props => {\n    const [, navigate] = useLocation()\n    const { base } = useRouter()\n\n    const href = props.href || props.to\n    const { children, onClick, tag } = props\n\n    const handleClick = useCallback(\n        event => {\n            if (\n                event.ctrlKey ||\n                event.metaKey ||\n                event.altKey ||\n                event.shiftKey ||\n                event.button !== 0\n            )\n                return\n\n            event.preventDefault()\n            navigate(href)\n            onClick && onClick(event)\n        },\n        [href, onClick, navigate]\n    )\n\n    const extraProps = { href: base + href, onClick: handleClick, to: null }\n    // default render 'a' component\n    const render = isValidElement(children) ? children : h(tag ? tag : \"a\", props)\n\n    return cloneElement(render, extraProps)\n}\n\nconst Switch = ({ children, location }) => {\n    const { matcher } = useRouter()\n    const [originalLocation] = useLocation()\n\n    children = Array.isArray(children) ? children : [children]\n\n    for (const element of children) {\n        let match:[boolean,params]\n\n        if (\n            isValidElement(element) &&\n            \n      // this allows to use different components that wrap Route\n      // inside of a switch, for example <AnimatedRoute />.\n      (match = element.props['path']\n          ? matcher(element.props['path'], location || originalLocation)\n          : [false, {}]\n      )[0]\n        )\n            return cloneElement(element, { match,path: element.props['path'] } as any)\n    }\n\n    // eslint-disable-next-line\n    console.warn(`\n        Switch component has no suitable render element;\n        please check path prop\n    `)\n    return null\n}\n\nconst Redirect = props => {\n    const [, push] = useLocation()\n    useLayoutEffect(() => {\n        // layout has finished \n        // replace url to new \n        push(\"replace\" ,props.href || props.to)\n\n    // we pass an empty array of dependecies to ensure that\n    // we only run the effect once after initial render\n    }, []) \n\n    return null\n}\n\n\nconst Lazy:React.FC<{loading:React.ReactNode,component:() => Promise<{default:React.ComponentType}>}> = ({ loading,component }) => {\n    const RC = lazy(component) \n    return h(Suspense,{ fallback: loading },h(RC))\n}\n    \nexport {\n    Lazy,\n    Redirect,\n    Switch,\n    useLeaveGuard,\n    connectGuard,\n    Link,\n    useRouter,\n    useLocation,\n    useRoute,\n    useNestRoute,\n    Router,\n    Route,\n    setRouteMode,\n    routeMode,\n    RouteMode\n}"],"names":["createContext","RouteMode","routeMode","useRef","useEffect","useCallback","useState","useContext","useLocation","useLocationHook","ExecuteGuardType","buildRouter","useRouter","useRoute","useNestRoute","h","cloneElement","isValidElement","useLayoutEffect","lazy","Suspense"],"mappings":"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"}